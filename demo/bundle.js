!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";var s;i.r(e),function(t){t[t.WATER=0]="WATER",t[t.WALL=1]="WALL",t[t.DELETE=2]="DELETE"}(s||(s={}));class n{constructor(t,e,i){this.x=t,this.y=e,this.node=i,this.isWall=!1,this.currentLoad=0,this.timeout=null}setSiblings(t,e,i,s){this.left=t,this.up=e,this.right=i,this.down=s}setLoad(t){this.currentLoad=t,this.updateClass(),this.queueDistribution()}addLoad(t){this.currentLoad+=t,this.currentLoad>100?this.currentLoad=100:this.currentLoad<0&&(this.currentLoad=0),this.updateClass(),this.queueDistribution()}erase(){this.isWall=!1,this.currentLoad=0,this.updateClass(),this.clearTimeout(),this.queueSiblings()}setAsWall(){this.isWall=!0,this.currentLoad=0,this.updateClass(),this.clearTimeout()}acceptsLoad(){return!this.isWall&&this.currentLoad<100}distribute(){this.timeout&&(this.timeout=null);let t=!1;if(0!==this.currentLoad){if(this.down&&this.down.acceptsLoad()){let e=Math.min(100-this.down.currentLoad,this.currentLoad);this.down.addLoad(e),this.currentLoad-=e,t=!0}if(this.currentLoad){let e=[];if(this.right&&this.right.acceptsLoad()&&this.right.currentLoad<this.currentLoad&&e.push(this.right),this.left&&this.left.acceptsLoad()&&this.left.currentLoad<this.currentLoad&&e.push(this.left),0!==e.length){let i=this.currentLoad+e.reduce((t,e)=>t+e.currentLoad,0),s=Math.floor(i/(e.length+1));e.forEach(e=>{Math.abs(e.currentLoad-s)>2&&(t=!0,e.setLoad(s)),i-=s}),this.currentLoad=i}}t&&(this.queueDistribution(),this.queueSiblings()),this.updateClass()}}queueDistribution(){null===this.timeout&&(this.timeout=setTimeout(this.distribute.bind(this),5))}clearTimeout(){this.timeout&&(this.timeout=null)}queueSiblings(){this.up&&!this.up.isWall&&this.up.currentLoad&&this.up.queueDistribution(),this.right&&!this.right.isWall&&this.right.currentLoad&&this.right.queueDistribution(),this.left&&!this.left.isWall&&this.left.currentLoad&&this.left.queueDistribution()}updateClass(){this.isWall?this.node.className="cell wall":this.currentLoad>=100?this.node.className="cell high":this.currentLoad>60?this.node.className="cell med":this.currentLoad>0?this.node.className="cell low":this.node.className="cell"}}let r=new class{constructor(){this.currentType=s.WATER}init(){const t=document.getElementById("drawSelector");t.children[0].addEventListener("click",()=>{this.updateDrawingType(s.WATER,t.children[0])}),t.children[1].addEventListener("click",()=>{this.updateDrawingType(s.WALL,t.children[1])}),t.children[2].addEventListener("click",()=>{this.updateDrawingType(s.DELETE,t.children[2])}),this.activeDomElement=t.children[0],this.activeDomElement.className="option active"}updateDrawingType(t,e){this.currentType!==t&&(this.currentType=t,this.activeDomElement.className="option",e.className="option active",this.activeDomElement=e)}};r.init();let l=document.getElementById("canvas");l.onmousedown=function(){if(null!==c)return;d(),c=setInterval(d,10)},l.onmouseup=h,l.onmouseleave=h;let u=[],o=null;for(let t=0;t<50;t++){let e=[];for(let i=0;i<50;i++){let s=document.createElement("div");s.className="cell",l.appendChild(s);let r=new n(t,i,s);s.onmouseover=function(){a(r)},e.push(r)}u.push(e)}for(let t=0;t<50;t++)for(let e=0;e<50;e++)u[t][e].setSiblings(u[t][e-1]?u[t][e-1]:null,u[t-1]?u[t-1][e]:null,u[t][e+1]?u[t][e+1]:null,u[t+1]?u[t+1][e]:null);function a(t){o=t}let c=null;function h(){null!==c&&(clearInterval(c),c=null)}function d(){switch(r.currentType){case s.WATER:o.setLoad(100);break;case s.WALL:o.setAsWall();break;case s.DELETE:o.erase()}}}]);